**Project on Databrick. Steps to complete each task**

--Modify the columns in table discounts to match the provided schema.

Steps to Complete
Write a SQL query that achieves the following:

Selects columns discountId, code, and price
Converts column discountId to type Long
Converts column price to type Double, multiplies it by 100 and then converts to type Integer
Saves this to a temporary view named q1Results

--Modify the columns in table discounts2 to match the provided schema.

Steps to complete
Write a SQL query on the table discounts2 that achieves the following:

Converts column active to type Boolean
Creates the column price by converting the column cents to type Double and dividing by 100
Drops the cents column
Saves this to a temporary view named q2Results

--Perform a join of two tables purchases and prices.

Steps to complete
Write a SQL query that acheives the following:

Performs an inner join on two tables purchases and prices on the column itemId
Includes only 3 columns from the purchases table: transactionId, itemId, and value

--Perform an outer join on two tables discounts and products store the results into q2Results view.

Steps to complete
Write a SQL query that achieves the following:

Performs an outer join on table discounts and products on the itemName column
Ensures that the joined view only includes one itemName column that comes from the products table

--Perform a cross join on two tables stores and articles.

Steps to complete
Perform a cross join on two tables stores and articles

--Extract the year and month from the Timestamp field in the table timetable1 and store records with only the 12th month into q1Results table.

Steps to complete
Write a SQL query that achieves the following:

Extracts the year and month from the Timestamp column from the table timetable1
Timestamp is an integer representing seconds since midnight on January 1st, 1970 (e.g. 1519344286). You must cast it as a timestamp to to extract years and months.
Filters records to include only month 12
Stores the resulting records in a temporary view named q1Results with the following schema.
column	type
Date	timestamp
Year	integer
Month	integer

--Extract the year, month and dayofyear from the Timestamp field in the table timetable2 and return records for only the 4th month.

Steps to complete
Write a SQL query that achieves the following:

Create Year, Month and DayOfYear columns from the Timestamp column in the timetable2 table
Timestamp is an integer representing seconds since midnight on January 1st, 1970 (e.g. 1519344286). You must cast it as a timestamp to to extract years, months, and day of year.
Filter records to include only month 4
Stores the records in a temporary table named q2Results with the following schema:
column	type
Date	timestamp
Year	integer
Month	integer
DayOfYear	integer

--Compute the minimum value from the Amount field for each unique value in the TrueFalse field in the table revenue1.

Steps to complete
Write a SQL query that achieves the following:

Computes the number of true and false records in the TrueFalse field from the table revenue1
Renames the new column to count
Store the records in a temporary view named q1Results with the following schema:
column	type
TrueFalse	boolean
MinAmount	int

--Compute the average of the Amount field for each unique value in the TrueFalse field in the table revenue3.

Steps to complete
Computes the average of Amount for True records and False records from the TrueFalse field in the table revenue3.
Renames the new column to avgAmount
Store the records in a temporary view named q3Results with the following schema:
column	type
TrueFalse	boolean
avgAmount	double

--Calculate the total Amount for YesNo values of true and false in 2002 and 2003 from the table revenue4.

Steps to complete
Casts the UTCTime field to Timestamp and names the new column Date
Extracts a Year column from the Date column
Filters for years greater than 2001 and less than or equal to 2003
Groups by YesNo and creates a pivot table to get the total Amount for each year and each value in YesNo
Represents each total amount as a float rounded to two decimal places
Store the results into a temporary table named q4results

--Compute sums of amount grouped by aisle after dropping null values from products table.

Steps to complete
Drops any rows that contain null values in either the itemId or the aisle column
Aggregates sums of the amount column grouped by aisle
Store the results into a temporary view named q5Results

--Compute averages of income grouped by itemName and month such that the results include averages across all months as well as a subtotal for an individual month from the sales table.

Steps to complete
Coalesces null values in the month column generated by the ROLLUP clause
Store the results into a temporary view named q6Results

--Get a distinct list of authors who have contributed blog posts in the "Company Blog" category.

Steps to complete
Write a SQL query that achieves the following:

Explodes the authors field to create an author field that contains only one author per row in table databricksBlog.
Limits records to contain only unique authors
Filters records where categories include "Company Blog"
Store the results in a temporary view named results

--Use the TRANSFORM function and the table finances to calculate interest for all cards issued to each user.

Steps to complete
Write a SQL query that achieves the following:

Displays cardholder's firstName, lastName, and a new column named interest
Uses TRANSFORM to extract charges for each card in the expenses column and calculates interest owed assuming a rate of 6.25%.
Stores the new values as an array in the interest column
Stores results in a temporary table named q1Results

--Use the table from Question 1, finances, to flag users whose records indicate that they made a late payment.

Steps to complete
Write a SQL query that achieves the following:

Displays cardholder's firstName, lastName, and a new column named lateFee
Uses the EXISTS function to flag customers who have made been charged a late payment fee.
Store the results in a temporary view named q2Results

--Use the REDUCE function to produce a query on the table charges that calculates total charges in dollars and total charges in Japanese Yen.

Steps to complete
Write a SQL query that achieves the following:

Uses the REDUCE function to calculate the total charges in US Dollars (given)
Uses the REDUCE function to convert the total charges to Japanese Yen using a conversion rate where 1 USD = 107.26 JPY
Stores the results in a temporary table named q3Results
